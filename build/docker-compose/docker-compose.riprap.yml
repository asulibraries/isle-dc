version: '3.7'
networks:
  default:
    internal: true
  gateway:
    external: true
services:
  riprap:
    restart: ${RESTART_POLICY:-unless-stopped}
    image: ${REPOSITORY:-local}/riprap:${TAG:-latest}
    environment: 
      RIPRAP_APP_SECRET: HbxNFSTG3aQQ7nJvLXIscHWDHa9kMJ63
      RIPRAP_LOG_LEVEL: debug
      RIPRAP_CONFIG_DRUPAL_BASEURL: https://${DOMAIN}
      RIPRAP_CONFIG_DRUPAL_CONTENT_TYPES: ${RIPRAP_CONFIG_DRUPAL_CONTENT_TYPES}
      RIPRAP_CONFIG_DRUPAL_FILE_FIELDNAMES: ${RIPRAP_CONFIG_DRUPAL_FILE_FIELDNAMES}
      RIPRAP_CONFIG_DRUPAL_MEDIA_TAGS: ${RIPRAP_CONFIG_DRUPAL_MEDIA_TAGS}
      RIPRAP_CONFIG_EMAIL_FROM: ${RIPRAP_CONFIG_EMAIL_FROM}
      RIPRAP_CONFIG_EMAIL_TO: ${RIPRAP_CONFIG_EMAIL_TO}}
      RIPRAP_CONFIG_FEDORA_BASEURL: ${RIPRAP_CONFIG_FEDORA_BASEURL}
      RIPRAP_CONFIG_FIXITY_ALGORITHM: ${RIPRAP_CONFIG_FIXITY_ALGORITHM}
      RIPRAP_CONFIG_PLUGINS_FETCHDIGEST: ${RIPRAP_CONFIG_PLUGINS_FETCHDIGEST}
      RIPRAP_CONFIG_PLUGINS_POSTCHECK: ${RIPRAP_CONFIG_PLUGINS_POSTCHECK}
      RIPRAP_CONFIG_PLUGINS_FETCHRESOURCELIST: ${RIPRAP_CONFIG_PLUGINS_FETCHRESOURCELIST}
    volumes:
      - riprap-data:/data:rw
volumes:
  riprap-data: {}